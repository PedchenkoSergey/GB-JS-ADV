(()=>{var t,e,o,s,n={780:t=>{t.exports={goods_item:{props:["good"],template:'\n    <div class="card" style="width: 18rem;">\n      <img src="static/img/test.png" class="card-img-top" alt="...">\n      <div class="card-body">\n        <h5 class="card-title">{{ good.product_name }}</h5>\n        <p class="card-text">Price: {{ good.price }}</p>\n        <a v-on:click="getAddCartItem(good.id_product)" class="btn btn-primary">Add to cart</a>\n      </div>\n    </div>',methods:{getAddCartItem:function(t){this.$emit("add-id-basket",t)}}}}},85:(t,e,o)=>{var s={components:{goods_item:o(780).goods_item},props:["goods"],template:'\n  <div class="goods-list wrapper">\n    <goods_item v-for="good in goods" :good="good" @add-id-basket="postAddCartItemInner"></goods_item>\n  </div>\n  ',methods:{postAddCartItemInner:function(t){this.$emit("add-id-basket-inner",t)}}};t.exports={goods_list:s}},843:t=>{t.exports={vue_goods_cart:{props:["cart_goods_list"],template:'\n  <div class="cart-element">\n    <table>\n        <thead style="background: #fc0">\n        <tr><th>Название</th><th>Цена</th><th>Количество</th><th>Удалить</th></tr> \x3c!--ряд с ячейками заголовков--\x3e\n        </thead>\n        <tfoot style="background: palegreen">\n        <tr>\n            <td>Итого в корзине на сумму:</td>\n            <td>{{cart_goods_list.amount}}</td>\n        </tr>\n        </tfoot>\n        <tbody style="background: #ccc">\n        <tr v-for="product in cart_goods_list.contents">\n          <td>{{product.product_name}}</td>\n          <td>{{product.price}}</td>\n          <td>{{product.quantity}}</td>\n          <td><a class="btn btn-danger" v-on:click="deleteElement(product.id_product)">Удалить</a></td>\n        </tr>\n        </tbody>\n    </table>\n  </div>\n  ',methods:{deleteElement:function(t){this.$emit("basket-delete",t)}}}}},293:t=>{t.exports={vue_goods_search:{props:["search_line_comp"],template:'\n  <div class="search-line">\n    <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3">\n      <input type="text" v-model="search_line_comp" class="goods-search form-control" placeholder="Поиск..." aria-label="Search">\n    </form>\n    <button class="search-button btn btn-primary" type="button" v-on:click="filter">Искать</button>\n  </div>',methods:{filter:function(){this.$emit("filter-comp",this.search_line_comp)}}}}},531:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>s});const s={vue_server_error:{props:["server_ok"],template:'\n    <p v-if="!server_ok">Пропала связь с сервером! Небходимо принять меры!</p>\n  '}}}},r={};function c(t){var e=r[t];if(void 0!==e)return e.exports;var o=r[t]={exports:{}};return n[t](o,o.exports,c),o.exports}c.d=(t,e)=>{for(var o in e)c.o(e,o)&&!c.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},c.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),c.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},t=c(85).goods_list,e=c(293).vue_goods_search,o=c(843).vue_goods_cart,s=c(531).vue_server_error,new Vue({components:{goods_list:t,vue_goods_search:e,vue_goods_cart:o,vue_server_error:s},el:"#app",data:{goods:[],filteredGoods:[],isVisibleCart:!1,cartGoodsList:[],cartSum:0,id_prod:0,serverOK:!1,API_URL:"http://localhost:3000",API_CATALOG:"catalogData",API_BASKET:"getBasket",API_ADD_BASKET:"addToCart",API_DELETE_BASKET:"deleteFromBasket"},methods:{makeGETRequest:function(t){return new Promise((function(e,o){var s;window.XMLHttpRequest?s=new XMLHttpRequest:window.ActiveXObject&&(s=new ActiveXObject("Microsoft.XMLHTTP")),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?e(s.responseText):o("Status is not 200: ".concat(s.status)))},s.open("GET",t,!0),s.send()}))},makePOSTRequest:function(t,e){return new Promise((function(o,s){var n;window.XMLHttpRequest?n=new XMLHttpRequest:window.ActiveXObject&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?o(n.responseText):s("Status is not 200: ".concat(n.status)))},n.open("POST",t,!0),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send(e)}))},filterGoods:function(t){var e=new RegExp(t,"i");this.filteredGoods=this.goods.filter((function(t){return e.test(t.product_name)}))},viewBasket:function(){this.isVisibleCart=!this.isVisibleCart,this.getCartItems()},getCartItems:function(){var t=this;this.makeGETRequest("".concat(this.API_URL,"/").concat(this.API_BASKET)).then((function(e){console.log("The basket consists of: ".concat(e)),t.cartGoodsList=JSON.parse(e)})).catch((function(e){console.log("Error: ".concat(e)),t.serverOK=!1}))},postAddCartItem:function(t){for(var e=this,o={},s=0;s<this.goods.length;s++)this.goods[s].id_product===t&&(o=this.goods[s]);console.log(JSON.stringify(o)),this.makePOSTRequest("".concat(this.API_URL,"/").concat(this.API_ADD_BASKET),JSON.stringify(o)).then((function(t){return console.log(t)})).then((function(){return e.getCartItems()})).catch((function(t){return console.log(t)}))},deleteBasketElement:function(t){for(var e=this,o={},s=0;s<this.goods.length;s++)this.goods[s].id_product===t&&(o=this.goods[s]);console.log(JSON.stringify(o)),this.makePOSTRequest("".concat(this.API_URL,"/").concat(this.API_DELETE_BASKET),JSON.stringify(o)).then((function(t){return console.log(t)})).then((function(){return e.getCartItems()})).catch((function(t){return console.log(t)}))}},mounted:function(){var t=this;this.makeGETRequest("".concat(this.API_URL,"/").concat(this.API_CATALOG)).then((function(e){t.goods=JSON.parse(e),t.filteredGoods=JSON.parse(e),t.serverOK=!0})).catch((function(e){console.log("Error: ".concat(e)),t.serverOK=!1}))}})})();